/*********************************************************************************************
程序名： 　　 TM0中断程序
编写人： 　　 Jaden
编写时间：　　2018 年 08月 21日
硬件支持：　　STC90C52  12MHz
接口说明：　　  
修改日志：　　
　　NO.1-								
/*********************************************************************************************
说明：

/*********************************************************************************************/
#include<reg52.h>
#define uchar unsigned char
#define uint unsigned int

uint number;
uchar LED_Number;

void DELSY_MS(uint T);
void init_TM0();
void display_led(uchar number);

uchar code LED_CODE[]={ 0x3f,0x06,0x5b,0x4f,
                        0x66,0x6d,0x7d,0x07,
                        0x7f,0x6f,0x77,0x7c,
                        0x39,0x5e,0x79,0x71};
/*********************************************************************************************
函数名：毫秒级CPU延时函数
调  用：DELAY_MS (?);
参  数：1~65535（参数不可为0）
返回值：无
结  果：占用CPU方式延时与参数数值相同的毫秒时间
备  注：应用于1T单片机时i<600，应用于12T单片机时i<125
/*********************************************************************************************/
void DELAY_MS(uint T)
{
	uint i;
	while(T--!=0)
	{
		for(i=0;i<500;i++);
	}
}

/*********************************************************************************************
函数名  TM0中断初始化
调  用：void init_TM0();
参  数：无
返回值：无
结  果：
备  注：
/*********************************************************************************************/
void init_TM0()
{
	EA=1;
	ET0=1;
	TMOD=0x01;
	TH0=65536-50000;
	TL0=65535-50000;
	TR0=1;

}
/*********************************************************************************************
函数名：TM中断0入口函数
调  用：void init_T0_interrupt() interrupt 1;
参  数：无
返回值：无
结  果：
备  注：
/*********************************************************************************************/
void init_T0_interrupt() interrupt 1
{
	TH0=65536-50000;
	TL0=65535-50000;
	number++;
	if(number>50)
	{
		number=0;
		LED_Number++;
		if(LED_Number>15)
		{
			LED_Number=0;
		}
	}
}
/*********************************************************************************************
函数名：数码管显示函数
调  用：void display_led();
参  数：无
返回值：无
结  果：
备  注：
/*********************************************************************************************/
void display_led(uchar number)
{
	P0= LED_CODE[number];		
}

/*********************************************************************************************
函数名：主函数
调  用：无
参  数：无
返回值：无
结  果：程序开始处，无限循环
备  注：
/**********************************************************************************************/
void main()
{
	number=0;
	init_TM0();
	DELAY_MS(100);
	LED_Number=2;
	while(1)
	{
		display_led(LED_Number);
	}
}
